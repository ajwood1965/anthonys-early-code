                                                            10 '  ****************   HAYSTERM/BAS  V.1.10   ***************20 '  *******   AUTO-DIAL W/ STERM & HAYES SMARTMODEM  ********30 '  ***************  TRS-80, MODELS I & III  ****************40 '  *****************   NEWDOS80 & LDOS   *******************50 '  **************   BY ROY HARRILL -- 6/82  ****************60 '  *********  DOWNLOADED FROM HOUSTON'S TBBS   *********65 '  *********************************************************70 CLS: CLEAR 500: T$="AUTO-DIAL"+CHR$(246)+STRING$(11,131)80 PRINT@24,T$: GOTO 16090 '100 '   MISC. SUBROUTINES110 FOR Z=1 TO 500*TD: NEXT Z: RETURN120 Z$="": Z$=INKEY$: IF Z$="" GOTO 120130 RETURN140 '150 '   INITIALIZE & READ IN PHONE DIRECTORY DATA160 CS$=CHR$(31): D$="": PN$="": DEFINT A-S170 READ DU$: D1(1)=PEEK(16639): D2(1)=PEEK(16640): DATA DUMMY180 IR=1  'FLAG   IR= INITIAL READ TO CAPTURE DATA POINTERS190 TP=3  'TOTAL PAGES IN DCTRY.; THERE CAN BE 1 TO 9192 REM             PAGES (SUBJECT TO MEM CONSTRAINTS) BUT THIS MUST194 REM        AGREE W/ # OF DATA SETS (TRIPLETS) ESTABLISHED BELOW.200 IF IR=1 THEN FOR Y=1 TO TP210 FOR X=1 TO 9: READ NA$(X),PN$(X),TC$(X): NEXT X220 IF IR=1 THEN D1(Y+1)=PEEK(16639):D2(Y+1)=PEEK(16640):NEXT Y: IR=0230 ' THIRD ITEM IN EACH DATA TRIPLET DENOTES TYPE OF CALL;232 REM    M= MODEM; A= AUTO-LOGON (M.C.M.S.) BOARD; P= PERSON;234 REM    R= RECORDING; 0 OR X FOR NULLS, ETC.240 ' THERE MUST BE EXACTLY 9 DATA TRIPLETS FOR EACH DIR PAGE.250 DATA CIS JAX., "904-246-9961", M, CIS WATS,"800-848-4480", M, CIS CUSTOMER SERVICE,"800-848-8990", P, TRADE '80 (ERIE),"814-898-2952", M, TRADE '80 (FT. LAUTERDALE),"305-525-1192", M, TIME,"436-6121", R, MOVE INFO,"432-0752", R, UNKNOWN COMPUTER251 DATA"439-9048", M, DWIGHT KELLY,"432-2228", P260 DATA DIRECTORY INFORMATION, "411", P, SPORTS, "900-976-1313" ,R, DANA SHEPARD,"???-????",P, JENNY DUVALL,"614-891-5601",P,RADIO SHACK (MALL),"883-7790",P, RADIO SHACK (MIDTOWN),"883-5037",P, SEARS,"883-4380",P,J & H  PRODUCE,"432-7316",P261 DATA B.C.C. (VOICE),"888-2097",P270 DATA B.C.C. (MODEM),"888-2098",M,"POLICE,FILRE,AMBULANCE",911,P,DIRECTORY ASSISTANCE,"411",P,TERRY RENFROE,"888-7043",P,JOE AGGRELLA,"XXX-XXX-XXXX",P,UGA CYBER 750,"439-4397",M, UGA CYBER 750 (ALTERNATE LINE),"439-4398",M,NUL,"XXX-XXXX",P280 DATA NUL,"0",X,NUL,"0",X,NUL,"0",X, USER ENTRY,"XXX-XXXX",X290 '300 '   RS232 INITIALIZATION310 OUT 232,0      'RESET MODEM STATUS REGISTER320 OUT 233,85     'SET BAUD RATE TO 300330 OUT 234,164    'EVEN PARITY; WORD LENGTH=7; 1 STOP BIT;332 REM             BREAK ENABLED; DTR TRUE; RTS TRUE340 '350 '   DISPLAY PHONE DIRECTORY & OBTAIN USER SELECTION360 PN=1  ' PN= CURRENT PAGE NUMBER OF DIRECTORY370 PRINT@24,T$: PRINT@128,CS$;CHR$(15); "PHONE DIRECTORY (PAGE"; PN; "OF"; TP; "PAGES) ---": PRINT: D$="":PN$="":NA$="":TC$=""380 POKE 16639,D1(PN): POKE 16640,D2(PN)390 FOR X=1 TO 9: READ NA$(X),PN$(X),TC$(X): PRINT X; "..... "; LEFT$(NA$(X),30);400 IF LEN(PN$(X))<7 AND PN$(X)<>"411" AND PN$(X)<>"911"PRINT: GOTO 420   'IGNORE NULL/BAD DATA410 PRINT TAB(56-LEN(PN$(X))); PN$(X)420 NEXT X430 IF PN=TP PRINTTAB(6); "<[>PREVIOUS ";: P$="["440 IF PN=1 THEN P$=CHR$(92): PRINTTAB(6); "<"; P$; ">NEXT ";450 IF PN>1 AND PN<TP PRINTTAB(6); "<[>PREVIOUS  =OR=  <"; CHR$(92); ">NEXT ";: P$="[' OR '"+CHR$(92)460 PRINT "PAGE   =OR=   E<X>IT PROGRAM": PRINTTAB(12) "  =OR=  <S>PECIFIC PAGE SELECTION"470 PRINT@960,"YOUR SELECTION PLEASE (1-9, OR '";P$;"' OR 'X' OR 'S')? "; CHR$(14);480 POKE 16639,D1(PN): POKE 16640,D2(PN)490 GOSUB 120: IF Z$="X" GOTO 1600500 IF Z$="%" GOTO 490   'FIX FOR MICROSOFT BASIC ERROR RE '%'510 IF Z$="S" PRINT@832,CHR$(15); CS$;: PRINT@960,"PAGE SELECTION PLEASE (1-";: PRINT USING "#"; TP;: PRINT ")? ";: PRINT CHR$(14); ELSE 550520 GOSUB 120: IF INSTR("123456789",Z$)=0 GOTO 520530 IF VAL(Z$)=PN PRINT@960,CHR$(15);CS$;:PRINT@832,;:GOTO 430540 IF VAL(Z$)>TP PRINT@960,CHR$(15);CS$;"SORRY, DIRECTORY CONTAINS ONLY"; TP; "PAGES.";: TD=.7:GOSUB 110: PRINT@960,CS$;: PRINT@832,;: PRINT CHR$(14);: GOTO 430 ELSE PN=VAL(Z$): GOTO 370550 IF Z$=CHR$(10) THEN IF PN<TP THEN PN=PN+1:GOTO 370 ELSE 490   'PAGE FWD.560 IF Z$="[" THEN IF PN>1 THEN PN=PN-1: GOTO 370 ELSE 490        'PAGE BKWD.570 IF VAL(Z$)<1 GOTO 490580 IF Z$<>"9" AND PN$(VAL(Z$))="0" PRINT@832, CHR$(15); CS$;: PRINT@960, "SORRY, NO PHONE # RECORDED FOR SELECTION "; Z$; ".";: TD=.7: GOSUB 110: PRINT@960,CS$;: PRINT@832,;: GOTO 430590 TC$=TC$(VAL(Z$))600 IF VAL(Z$)<9 THEN PN$=PN$(VAL(Z$)): NA$=NA$(VAL(Z$))610 IF LEN(PN$)=12 GOTO 840  'ASSUMES ALL LONG DIST. PHONE #S IN612 REM                      DATA STMTS. ARE EXACTLY 12 CHARS.614 REM                       LONG (INCLUDING 2 HYPHENS).620 IF VAL(Z$)<9 GOTO 890630 '640 '   USER PHONE NUMBER INPUT ROUTINE650 PRINT@128,CHR$(15);CS$;: PRINT@192, "ENTER PHONE # (DIGITS, SPACES OR -() ONLY)? ";660 PRINT@896, CHR$(15); "ENTER AN 'E' ALONE OR ANYWHERE WITHIN # TO ESCAPE.";: PRINT@236,CHR$(30);: LINEINPUT PN$670 IF PN$="411" THEN TC$="P": GOTO 890680 C$="E ()-0123456789": C1$=RIGHT$(C$,10): C2$="": NN=0: NN$="": XF=0690 FOR X=1 TO LEN(PN$): C2$=MID$(PN$,X,1)700 IF INSTR(C2$,"E") GOTO 360710 IF INSTR(C$,C2$)=0 GOTO 820720 IF INSTR(C1$,C2$)>0 THEN NN=NN+1730 IF NN=1 AND C2$="0" GOTO 820740 IF NN=1 AND XF=0 THEN NN$=C2$: XF=1750 IF NN>11 GOTO 820 ELSE NEXT X760 IF NN<7 OR NN=8 OR NN=9 GOTO 820770 IF NN=11 AND NN$<>"1" GOTO 820780 PRINT@320,CS$; "ARE YOU CALLING A --": PRINT790 PRINT "<M>ODEM - NO AUTO-LOGON": PRINT "<A>UTO-LOGON BOARD (M.C.M.S.)": PRINT"<P>ERSON (VOICE)": PRINT"<R>ECORDING (VOICE)"800 PRINT:PRINT"ENTER TYPE OF CALL ('M' OR 'A' OR 'P' OR 'R')?"810 GOSUB120:IF INSTR("MAPR",Z$)=0 GOTO 810 ELSE TC$=Z$:GOTO890820 TD=.1:FOR X=1 TO 4:PRINT@396,"I N V A L I D  N U M B E R";:GOSUB 110: PRINT@396,"             ";:GOSUB 110:NEXT X:PRINT@396, CHR$(30);: GOTO 660830 IF NN=7 GOTO 890840 IF INSTR(LEFT$(PN$,6),"800")=0 PRINT@128, CS$; CHR$(15);: PRINT@401,"T O L L  C A L L"850 PRINT@836, "<P> TO PROCEED  ---  ANY OTHER KEY TO ABORT? "; CHR$(14);860 GOSUB 120: IF Z$<>"P" PRINT CHR$(15);: GOTO 360865 PN$="1-"+PN$ 'ADD 1 FOR LONG DISTANCE870 '880 '   DIAL PHONE NUMBER890 IF TC$<>"M" AND TC$<>"A" THEN VC$=";S7=90 O" ELSE VC$=";S7=30 O"900 'PB$="9," 'ACTIVATE THIS LINE ONLY IF PBX S/BOARD REQS. '9'910 D$="ATV0DT"+PB$+PN$+VC$+CHR$(13)    'CONSTRUCT DIAL COMMAND920 PRINT@128,CS$;CHR$(15);: PRINT@262, "DIALING:  "; NA$+" ---> "+PN$930 FOR T=1 TO LEN(D$)940 IF (INP(234) AND 64)=0 GOTO 940    'WAIT UNTIL PORT CLEARS950 OUT 235, ASC(MID$(D$,T,1))         'SEND CHARACTER TO MODEM960 NEXT T970 IF TC$<>"M" AND TC$<>"A" GOTO 1240980 '990 '   WAIT FOR CARRIER DETECT (MODEM CALL)1000 IF NN>7 THEN TD=6: GOSUB 110 ELSE TD=3: GOSUB 1101010 PRINT@390,CHR$(15); "WAITING FOR ANSWER (CARRIER DETECT)."1020 PRINT@896,"PRESS 'E' TO ESCAPE. "; CHR$(14);1030 FOR X=1 TO 500 'LOOP APPROX.15 SECS. FOR CD OR USER CANCEL1040 Z$="": Z$=INKEY$: IF Z$="" GOTO 10601050 IF Z$="E" OUT 235,88: PRINT@192,CS$; "(CALL CANCELLED BY USER)": GOTO 11401060 IF INP(235)<>49 GOTO1100 'TEST FOR '3' RECEIVED FROM MODEM1070 PRINT CHR$(15);:PRINT@128,CS$: PRINT@258,;: B$="CONNECTION MADE ...": GOSUB 15601080 IF TC$="A" GOSUB 1440: TD=1: GOSUB 110: PRINT@128,CS$;       'THIS LINE IS FOR AUTO-LOGON TO 'ONE-LINER' M.C.M.S. BOARDS      (MARKED BY 'A' IN DIRECTORY # DATA STMTS. OR USER-PROMPT FOR    USER-ENTERED #S).1090 PRINT@518,;: B$="GOING TO < STERM/CMD > ...": GOSUB 1560: CMD"I","STERM1100 NEXT X1110 '1120 '   NO CONNECTION (MODEM CALL) - USER OPTIONS1130 OUT 235,88: PRINT@128,CS$; "NO CONNECTION FOR:  "; PN$1140 TD=.5: GOSUB 110: PRINT: PRINT "YOU MAY --": PRINT1150 PRINT "   <R>EDIAL "; PN$1160 PRINT "   <D>IAL ANOTHER NUMBER"1170 PRINT "   E<X>IT PROGRAM"1180 PRINT: PRINT "ENTER YOUR CHOICE ('R' OR 'D' OR 'X')? ";1190 GOSUB 120: IF INSTR("RDX",Z$)=0 GOTO 11901200 ON INSTR("RDX",Z$) GOTO 920,360,16001210 IF Z$="D" GOTO 360 ELSE 16001220 '1230 '   VOICE-CALL ROUTINE1240 IF Z$="E" GOTO 14101250 TD=2: GOSUB 110: PRINT@128,CS$; CHR$(15);1260 IF TC$="P" PRINT@256, "IF NO ANSWER OR BUSY, PRESS 'E' TO CANCEL.": PRINT: PRINT "IF ANSWER, PICK UP PHONE TO TALK; THEN PRESS 'E'.": GOTO 12901270 IF TC$="R" PRINT@256, "PRESS 'E' TO HANG UP WHEN FINISHED LISTENING. "; CHR$(14);1280 IF PN$="436-6121" OR PN$="4366121" PRINT CHR$(15);: TI=1 ELSE TI=01290 FOR Z=1 TO 4000 'REGULATES OVERALL TIME MODEM STAYS ON1292 REM   FOR PHONE PICK-UP (PERSON) OR LISTENING (RECORDING).1300 Z$="": Z$=INKEY$: IF Z$="E" GOTO 14101310 IF TI=0 GOTO 14001320 HR=PEEK(16451):MI=PEEK(16450):SE=PEEK(16449)  'GET TIME1330 IF HR>11 THEN RT$="  P.M." ELSE RT$="  A.M."1340 IF HR>12 THEN HR=HR-12 ELSE IF HR=0 THEN HR=121350 PRINT@384,"YOUR TRS-80'S TIME SETTING IS -->";1360 PRINT@419,USING"##:"; HR;1370 IF MI<10 PRINT@422,"0";USING"#:";MI; ELSE PRINT@422,USING"##:";MI;1380 IF SE<10 PRINT@425,"0";USING"#";SE; ELSE PRINT@425,USING"##";SE;1390 PRINT RT$;1400 NEXT Z1410 OUT 235,88: GOTO 3601420 '1430 '   AUTO LOGON SUBR. - FOR 'ONE-LINER' M.C.M.S. BOARDS1440 B1$="PLEASE WAIT AWHILE ...":B2$="SENDING AUTO-LOGON .....1450 B$=B1$: GOSUB 1540: TD=.5: GOSUB 110: B$=B2$: GOSUB 15501460 IF INP(235)<>5 GOTO 1460 'WAIT FOR X'05'(AUTO-LOG.TRIGGER)1470 TD=.15: GOSUB 1101480 LO$="LAST;FIRST/PASSWORD"+CHR$(13)+"S"1490 FOR Z=1 TO LEN(LO$)1500 IF (INP(234) AND 64)=0 GOTO 15001510 OUT 235, ASC(MID$(LO$,Z,1))1520 NEXT Z1530 RETURN1540 PRINT@514,;: GOTO 15601550 PRINT@642,;1560 FOR ZZ=1 TO LEN(B$): PRINT MID$(B$,ZZ,1)+" ";:  NEXT ZZ1570 RETURN1580 '1590 '   END PROGRAM ROUTINE1600 PRINT@128,CHR$(15);CS$;: E$="HAVE A NICE DAY!!"1610 TD=0: PRINT@396,;: FOR X=1 TO LEN(E$): PRINT MID$(E$,X,1)+" ";: GOSUB 110: NEXT X: TD=.6: GOSUB 110: CLS1620 END1997 '1998 '   UPDATED AS OF: 6/20/821999 SAVE "HAYSTERM/BAS:2",A2000 REM  *  END OF HAYSTERM/BAS  *EXIT                                                     