Anthony Wood12739 Grand Cross Ln.Houston, TX 77072(713) 495-4322                        Microcalc 64     Microcalc 64 is an electroic spread sheet for your Commodore 64. It allows you to balance your budget or plan financial ventures with equal ease. Although Microcalc 64 is not as powerful as commercially available spread sheets, it is a very useful tool for home and business     Before I describe how to use Microcalc 64, a description of how to type it in is in order.  The main program loads a machine language subroutine from disk; therefore, before you can run Microcalc 64, this machine language subroutine needs to be created.  The program "EVAL.BAS" will do this for you--it pokes the data into memory and then saves it to disk under the name "EVAL.BIN," the file that is loaded by Microcalc 64.     When you run "EVAL.BAS," the computer will crash after it saves the machine language program to disk. Be sure you save "EVAL.BAS" after you type it in and before you run it--it will be lost if it runs correctly.  "EVAL.BAS" also checks for errors in the data before it runs.  If you have made a mistake in typing the data, the aproximate area of your error will be displayed and execution will be stopped.     For those of you who like assembly language, I have provided the assembly listing of "EVAL.BIN".  It has two purposes--tokenizing text and evaluating an expression.  The tokenizing routine tokenizes the input buffer;  Microcalc 64 then peeks the tokenized expression and saves it in a string variable.  The evaluate routine evaluates the expression in the first BASIC variable--this must be a string containing a tokenized formula.  The most difficult part in writing these subroutines was the case of an error.  An error, such as divide by zero, in the evaluate routine normally causes a return to BASIC and halts program execution. I tried several methods to catch errors, including changing the error and warm start vectors.  These both succeded in catching some errors, but not all.  Finaly, I intercepted the print routine.  Because all error measages are printed, this will catch them all--almost.  In some cases it will not catch a TYPE MISMATCH error; I have no idea why. If you know, please let me know.     Using Microcalc 64     When you first run Microcalc 64, you will see columns labeled with letters and rows labeled with numbers.  Each "box," or "cell" in the spread sheet is identified with a letter-number combination. For example, the upper left hand box is identified as A(1). An example will help make this clear--run Microcalc 64 and type WAGES (do not forget to press return). A few things will happen; first, the word "label" will appear. Underneath this, the word "wages" will appear as you type it in. The slot where wages apears on the spread sheet is a box (or cell, depending on who you talk to.)     When you entered "wages," the word label appeared beacause the first character you entered was a letter. Microcalc 64 allows for two types of entities to exist in a box. These are labels and values (values are the same thing as formulas to Microcalc 64.) A value can be a number, or a formula. For example, enter "100." You can see that Microcalc 64 takes this as a value.  Boxes with values in them can be referenced by other boxes--this is the power of an electronic spread sheet.  As an example, enter "50.5". Now move the cursor down with the cursor keys at the lower right of the keyboard. After your cursor (the ">") is at A(2) enter "200". Move the cursor down to A(3) and type "+A(1)+A(2)" (don't type the quotes, of course.) Now, press the ! key. 250.5 should appear in A(3).     Notice that at the upper left of the screen, the formula is still displayed. As you move the cursor around, the formula or label of that box appears in the upper left of the screen. Also, notice that there is a plus sign before the "A" above. This is so Microcalc does not take the formula as a label. All values to be calculated must start with a a plus or minus sign, a period, or a digit.     In the above example, you had to press "!" to calculate the answer; however, it is possible to tell Microcalc to automatically calculate the values of all formulas after each new entry. Press the "/" key--this will give you a menu of possible comands. Now enter "C," for calculate. Answer "Y" to the prompt. Microcalc 64 will now automatically calculate all formulas every time a value is changed. For example, move the cursor to A(1) and enter "45".  A(3) should change to show the new value.     When Microcalc 64 performs its calculations, it starts at column A, calculating A(1),A(2),A(3)... etc., then it goes on to columns B, C, D, etc. However, Microcalc does not calculate an entire column, instead, it calculates until a blank box is reached. Columns are calculated until a blank box in positon 1 is found. Therfore, do not leave blank boxes in the middle of your spread sheet. If you do, Microcalc 64 will ignore those boxs that are after the blank box.     A box may contain any formula that is valid in BASIC. These are all valid formulas: +A(3)*C(2)-100+SIN(A(1)) or +B(2)*B(3) or .75*A(1). Notice that formulas should start with a plus, minus, period, or digit.     A formula that is invalid or results in an error, such as divide by zero, will display "ERROR" in the box in which the error occurred.                       A Sample Spred sheet     The following section will show one possible use for Microcalc 64--calculating annual wages.  First, clear the spread sheet by pressing /N (/ then N with no return). Now enter the following items in the indicated boxs:  A                           B1 Salary                   200002 tax bracket              203 net income               +B(1)-B(1)*B(2)/1004 weekly income            +B(3)/52     Now, enter /CY and try changing the various boxes.  Use different values for B(1) and B(2).                 Microcalc 64 Commands     These commands can be entered when the cursor is flashing: !     causes the entire spread sheet to be calculated. home  returns cursor to A(1) F7    scrolls down an entire page F5    scrolls up an entire page /     go to command menu     The following are command menu options: C   This allows you to select whether or not you want the entire spread sheet recalculated after each entry.  By not re-calculating the entire spread sheet, formula entry is made faster. D   Deletes a box or column the cursor is on. E   Edit.  This allows you to edit the box which the cursor is currently on top off.  The formula or label will be displayed at the upper left of the screen and can be edited using the insert/delete/cursor keys as in BASIC. F   Print formulas.  If you have a printer, this option will make a hardcopy of the formula list form the cursor position to an ending positon you specify. I    Insert a box or column at the current cursor position. The one major drawback to the I and D commands is that they do NOT alter references to the inserted/deleted box. You will have to do this with the E command if nessesary. L    Load a saved spread sheet from disk. N    New.  This clears the spread sheet. P    Print the spread sheet from the current cursor position to a position specified by you.  This prints the spread sheet as you see it on the screen. Q    Quit.  Exits back to BASIC. S    Save the current spread sheet to disk. W    Width change.  You can change the width of the columns from 7 to 37.  The original value is 18, wide enough for two columns. $    Round all values to two decimal places.  This alows you to line up values neatly, if you wish, before printing the spread sheet on a printer.              A "real" Spred Sheet?     Microcalc 64 is not as powerful as a spread sheet you could buy--mainly because Microcalc 64 is part BASIC.  This inherent handicap has caused me to make Microclac 64 commands somewhat different from standard "Visicalc" commands.  For instance, commercial spread sheets do not have a "C" command--they are fast enough that one is not needed.  Also, most spread sheets are larger, ie, the columns can go past Z and on to BC, BD, ect.  It would have been relatively easy to make microcalc 64 larger, but it would also have been useless.  A job that needs to be that large should not be run on Microcalc 64 in the first place.  Microcalc 64 slows down significantly when using large amounts of data.  You will notice this some times when the screen scrolls--it will seem to freeze for a few seconds occasionally. This is a problem with Commodore BASIC called garbage collection; it has to do with the way strings are stored by BASIC and can not be avoided.      For all its short comings, however, Microcalc 64 is a usable and helpful program.  At the very least, you can learn to use an electronic spread sheet and decide whether or not your needs require you to spend the money to buy one. à    >6 M  P         