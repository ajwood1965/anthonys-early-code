°°±°° ;MICRO ADVENTURE RUN TIME PACKAGE°°±±° ;(C) COPYRIGHT 1983 ANTHONY WOOD°°±²° ;°°±³° ; 4/24/83°°±´° ;POSITION OF ADVENTURE°°±µ° 	ORG	5200H°°±¶° BEGIN	CALL	01C9H°°±¶² 	LD	A,15°°±¶´ 	CALL	33H°°±·° 	LD	HL,(MEM+16)°°±¸° 	CALL	SCRPRT°°±¹° 	CALL	49H°°±¹± 	CALL	01C9H°°±¹² 	LD	HL,(MEM+14)°°±¹´ BEG	LD	A,(HL)°°±¹¶ 	CP	0FFH°°±¹¸ 	JR	Z,PUMP°°²°° 	INC	HL°°²°² 	JR	BEG°°²°´ PUMP	LD	DE,(MEM+10)°°²°¶ 	XOR	A°°²°¸ 	SBC	HL,DE°°²°¹ 	INC	HL°°²±° 	LD	(LEN),HL°°²±² 	PUSH	HL°°²±´ 	POP	BC°°²±¶ 	LD	DE,(MEM+14)°°²±¸ 	LD	HL,30T°°²²° 	ADD	HL,DE°°²²² 	EX	DE,HL°°²²´ 	LD	HL,(MEM+10)°°²²¶ 	LDIR°°²²· 	JR	START2°°²²¸ START	CALL	CTOP°°²²¹ 	LD	HL,3C00H°°²³° 	LD	(401DH+3),HL°°²³¶ START2	LD	HL,LINE°°²³· 	CALL	PRINT°°²³¸ 	LD	HL,PRED°°²³¹ 	CALL	PRINT°°²´° 	LD	A,(RUM)°°²´¸ 	LD	HL,(MEM+8)	;RM DES TABLE°°²µ° 	CALL	LOOK		;FIND THE DESCRIP. LOC.°°²¶° 	CALL	PRINT°°²·° 	CALL	RSFIND		;FIND CURRENT ROOM INV.°°²¸° 	LD	B,20D		;TEST FOR°°²¹° 	XOR	A		;EMPTY ROOM°°²¹µ 	PUSH	HL°°³°° CHKCLR	ADD	A,(HL)°°³°µ 	INC	A		;MAKE FFH A 0°°³±° 	INC	HL°°³²° 	DJNZ	CHKCLR°°³³° 	OR	A°°³³µ 	POP	HL°°³´° 	JR	Z,EMPTY		;GO IF AN EMPTY ROOM°°³´µ 	PUSH	HL°°³µ° 	LD	HL,ISEE°°³¶° 	CALL	PRINT		;"I CAN SEE: "°°³¶µ 	POP	HL°°³·° 	LD	B,20D°°³¸° ITEM	LD	A,(HL)°°³¹° 	CP	0FFH°°´°° 	JR	Z,NOTH		;FF MEANS EMPTY SLOT°°´±° 	PUSH	HL°°´²° 	LD	HL,(MEM+2)	;NOUN TABLE°°´³° 	CALL	LOOK°°´´° 	CALL	TYPE°°´µ° 	LD	HL,DSP		; ". "°°´¶° 	CALL	PRINT°°´·° 	POP	HL°°´¸° NOTH	INC	HL°°´¸µ 	DJNZ	ITEM°°´¹° 	LD	A,10°°µ°° 	CALL	ROLL°°µ±° EMPTY	CALL	EXTFND°°µ¸° 	PUSH	HL°°µ¹° 	LD	B,6°°¶°° 	XOR	A		;SEE IF NO EXITS°°¶±° EXT2	ADD	A,(HL)°°¶±µ 	INC	A		;MAKE FFH A 0°°¶²° 	INC	HL°°¶³° 	DJNZ	EXT2°°¶´° 	POP	HL°°¶µ° 	OR	A°°¶¶° 	JR	Z,NOEXIT	;GO IF NO EXITS°°¶¶± 	PUSH	HL°°¶¶² 	LD	HL,WAY°°¶¶³ 	CALL	PRINT°°¶¶´ 	POP	HL		;"OBVIOUS EXITS:"°°¶·° 	LD	A,(HL)		;EXIT TO NORTH?°°¶¸° 	INC	A		;NOW 0 ID NO°°¶¹° 	JR	Z,NO1°°·°° 	PUSH	HL°°·±° 	LD	HL,NORTH°°·²° 	CALL	PRINT°°·³° 	POP	HL°°·´° NO1	INC	HL°°·µ° 	LD	A,(HL)		;EXIT TO SOUTH?°°·¶° 	INC	A°°··° 	JR	Z,NO2°°·¸° 	PUSH	HL°°·¹° 	LD	HL,SOUTH°°¸°° 	CALL	PRINT°°¸±° 	POP	HL°°¸±µ NO2	INC	HL°°¸²° 	LD	A,(HL)		;EXIT TO EAST?°°¸³° 	INC	A°°¸´° 	JR	Z,NO3°°¸µ° 	PUSH	HL°°¸¶° 	LD	HL,EAST°°¸·° 	CALL	PRINT°°¸¸° 	POP	HL°°¸¹° NO3	INC	HL°°¹°° 	LD	A,(HL)		;EXIT TO WEST?°°¹±° 	INC	A°°¹²° 	JR	Z,NO4°°¹³° 	PUSH	HL°°¹´° 	LD	HL,WEST°°¹µ° 	CALL	PRINT°°¹¶° 	POP	HL°°¹·° NO4	INC	HL°°¹¸° 	LD	A,(HL)		;EXIT UP?°°¹¹° 	INC	A°±°°° 	JR	Z,NO5°±°±° 	PUSH	HL°±°²° 	LD	HL,UP°±°³° 	CALL	PRINT°±°³² 	LD	HL,DSP°±°³´ 	CALL	PRINT°±°´° 	POP	HL°±°µ° NO5	INC	HL		;EXIT DOWN?°±°¶° 	LD	A,(HL)°±°·° 	INC	A°±°¸° 	JR	Z,NO6°±°¹° 	LD	HL,DOWN°±±°° 	CALL	PRINT°±±±° NO6	LD	A,10°±±²° 	CALL	ROLL°±±²± NOEXIT	LD	HL,LINE°±±²³ 	CALL	PRINT		;<------- ... ---->°±±²µ 	LD	HL,(401DH+3)°±±²· 	LD	(LIN),HL°±±´± 	LD	HL,(CURPOS)°±±´² 	LD	DE,00°±±´³ 	XOR	A°±±´´ 	SBC	HL,DE°±±´µ 	JR	Z,INP°±±´¸ 	LD	HL,(CURPOS)°±±´¹ 	LD	(401DH+3),HL°±±µ° INP	LD	A,(SIZE)°±±µ± 	INC	A°±±µ² 	LD	IX,(MEM+12)°±±µ³ 	LD	(SIZE),A°±±µ´ 	CP	(IX+1)°±±µµ 	JR	NZ,INPP°±±µ¶ 	XOR	A°±±µ· 	LD	(SIZE),A°±±µ¸ 	LD	HL,(MEM+12)°±±µ¹ 	INC	(HL)°±±¶² INPP	LD	HL,(MEM+18)°±±¶³ 	JP	CNT3A°±±¶¸ INPT	LD	HL,PROM°±±¶¹ 	CALL	PRINT°±±·° 	CALL	INPUT		;TELL ME WHAT TO DO NOW?°±±¸° 	LD	IX,BUFFER°±±¹° 	LD	A,(IX+0)°±²°° 	CP	0DH°±²±° 	JP	Z,INP		;GO IF JUST <ENTER>°±²²° 	LD	A,(IX+1)	;CHECK FOR 1 LETTER INPUT°±²³° 	CP	0DH°±²´° 	JR	NZ,NOPE		;GO IF TWO+ LETTERS°±²µ° 	LD	A,(IX+0)	;GET LETTER°±²¶° 	CP	'N'°±²·° 	JR	Z,NRTH°±²¸° 	CP	'S'°±²¹° 	JR	Z,SOTH°±³°° 	CP	'E'°±³±° 	JR	Z,EST°±³²° 	CP	'W'°±³³° 	JR	Z,WST°±³´° 	CP	'U'°±³µ° 	JP	Z,UPP°±³¶° 	CP	'D'°±³·° 	JP	Z,DN°±³¸° 	CP	'I'°±³¹° 	JP	Z,INJN°±´°° 	LD	HL,BADIN°±´±° 	CALL	PRINT°±´²° 	JP	INP°±´³° NOPE	LD	DE,BUFFER°±´´° 	LD	HL,NORTH°±´µ° 	CALL	CMPR°±´¶° 	JR	Z,NRTH°±´·° 	LD	HL,SOUTH°±´¸° 	CALL	CMPR°±´¹° 	JR	Z,SOTH°±µ°° 	LD	HL,EAST°±µ±° 	CALL	CMPR°±µ²° 	JR	Z,EST°±µ³° 	LD	HL,WEST°±µ´° 	CALL	CMPR°±µµ° 	JR	Z,WST°±µ¶° 	LD	HL,UP°±µ·° 	CALL	CMPR°±µ¸° 	JR	Z,UPP°±µ¹° 	LD	HL,DOWN°±¶°° 	CALL	CMPR°±¶±° 	JR	Z,DN°±¶²° 	JP	CNT1°±¶³° NRTH	CALL	EXTFND°±¶´° 	LD	A,(HL)°±¶µ° 	CP	0FFH°±¶¶° 	JR	Z,ERR1°±¶·° 	LD	(RUM),A°±¶¸° 	JP	START°±¶¹° SOTH	CALL	EXTFND°±·°° 	LD	A,(IX+1)°±·±° 	CP	0FFH°±·²° 	JR	Z,ERR1°±·³° 	LD	(RUM),A°±·´° 	JP	START°±·µ° EST	CALL	EXTFND°±·¶° 	LD	A,(IX+2)°±··° 	CP	0FFH°±·¸° 	JR	Z,ERR1°±·¹° 	LD	(RUM),A°±¸°° 	JP	START°±¸±° WST	CALL	EXTFND°±¸²° 	LD	A,(IX+3)°±¸³° 	CP	0FFH°±¸´° 	JR	Z,ERR1°±¸µ° 	LD	(RUM),A°±¸¶° 	JP	START°±¸·° UPP	CALL	EXTFND°±¸¸° 	LD	A,(IX+4)°±¸¹° 	CP	0FFH°±¹°° 	JR	Z,ERR1°±¹±° 	LD	(RUM),A°±¹²° 	JP	START°±¹³° DN	CALL	EXTFND°±¹´° 	LD	A,(IX+5)°±¹µ° 	CP	0FFH°±¹¶° 	JR	Z,ERR1°±¹·° 	LD	(RUM),A°±¹¸° 	JP	START°±¹¹° ERR1	LD	HL,BADDI°²°°° 	CALL	PRINT°²°±° 	JP	INP°²°²° CNT1	LD	DE,BUFFER°²°³° 	LD	HL,INV°²°´° 	CALL	CMPR°²°µ° 	JR	NZ,CNT2°²°¶° INJN	LD	HL,(MEM+14)		;START OF INV.°²°·° 	LD	A,(HL)°²°¸° 	CP	0FFH°²°¹° 	JR	NZ,OK°²±°° 	LD	HL,INVEMP°²±±° 	CALL	PRINT			;NOTHING HERE°²±²° 	JP	INP°²±³° OK	LD	A,(HL)°²±´° 	CP	0FFH°²±µ° 	JP	Z,LF°²±¶° 	PUSH	HL°²±¶µ 	LD	HL,(MEM+2)°²±·° 	CALL	LOOK°²±¸° 	CALL	TYPE°²±¹° 	LD	HL,DSP°²²°° 	CALL	PRINT°²²±° 	POP	HL°²²²° 	INC	HL°²²³° 	JR	OK°²²³² LF	LD	A,0DH°²²³´ 	CALL	ROLL°²²³¶ 	JP	INP°²²´° CNT2	LD	HL,BUFFER	;FIND NOUN...°²²´² 	LD	DE,SAV°²²´´ 	CALL	CMPR°²²´¶ 	JP	Z,SAVEG°²²´· 	LD	DE,LOA°²²´¸ 	CALL	CMPR°²²´¹ 	JP	Z,LOADG°²²µ° BILL	LD	A,(HL)°²²µµ 	INC	HL°²²¶° 	CP	20H		;SP°²²·° 	JR	Z,GOTIT°²²¸° 	CP	0DH°²²¹° 	JR	NZ,BILL°²³°° 	LD	A,0FFH		;NO NOUN MARKER°²³±° 	LD	(NOUN),A°²³²° 	JR	VER°²³³° GOTIT	LD	(NN),HL		;SAVE NOUN POS FOR LATER°²³´° 	EX	DE,HL°²³µ° 	LD	HL,(MEM+2)	;NOUN TABLE°²³¶° 	CALL	FIND2		;FIND NOUN NUMBER°²³·° 	LD	A,B°²³¸° 	JR	NZ,NERR°²³¹° 	LD	(NOUN),A°²´°° VER	LD	HL,(MEM+4)	;VERB TABLE°²´±° 	LD	DE,BUFFER	;POINT TO VERB°²´²° 	CALL	FIND°²´²µ 	LD	A,B°²´³° 	LD	(VERB),A°²´´° 	JR	Z,CNT3°²´µ° 	LD	HL,VERR°²´¶° 	CALL	PRINT°²´¶² 	LD	HL,BUFFER°²´¶´ 	CALL	PUT°²´¶¶ 	LD	A,'.'°²´¶· 	CALL	ROLL°²´¶¸ 	LD	A,0DH°²´¶¹ 	CALL	ROLL°²´·° 	JP	INP°²´¸° NERR	LD	HL,ERRN°²´¹° 	CALL	PRINT°²µ°° 	LD	HL,(NN)°²µ±° 	CALL	PUT°²µ²° 	LD	HL,ERRN2°²µ³° 	CALL	PRINT°²µ´° 	JP	INP°²µµ° ;START OF PROGRAM INTERPRATATION BELOW°²µ¶° CNT3	LD	HL,MEM+20	;START OF PROGRAM°²µ·° CNT3A	LD	A,(HL)°²µ·² 	BIT	7,A°²µ·´ 	JR	Z,OKOK°²µ·¶ 	CALL	SKIP		;SKIP THIS IF NESRY°²µ·¸ 	JR	C,CNT3A°²µ¸° OKOK	CP	01°²µ¹° 	JP	Z,INPN		;IN+NOUN°²¶°° 	CP	02°²¶±° 	JP	Z,INMN		;IN-NOUN°²¶²° 	CP	03°²¶³° 	JP	Z,RMPN		;RM+NOUN°²¶´° 	CP	04°²¶µ° 	JP	Z,RMMN		;RM-NOUN°²¶¶° 	CP	05°²¶·° 	JP	Z,CIN		;?IN:NOUN°²¶¸° 	CP	06°²¶¹° 	JP	Z,CRN		;?RM:NOUN°²·°° 	CP	07°²·±° 	JP	Z,START		;RET°²·²° 	CP	08°²·³° 	JP	Z,CHKN		;NCHK°²·´° 	CP	09°²·µ° 	JP	Z,DELN		;DEL:NOUN°²·¶° 	CP	10°²··° 	JP	Z,INP°²·¸° 	CP	11°²·¹° 	JP	Z,TY		;TY:°²¸°° 	CP	12°²¸±° 	JP	Z,RMP		;RM+°²¸²° 	CP	13°²¸³° 	JP	Z,RMM		;RM-°²¸´° 	CP	14°²¸µ° 	JP	Z,INVP		;IN+°²¸¶° 	CP	15°²¸·° 	JP	Z,INVM		;IN-°²¸¸° 	CP	16°²¸¹° 	JP	Z,FINC		;INC°²¹°° 	CP	17°²¹±° 	JP	Z,FDEC		;DEC°²¹²° 	CP	18°²¹³° 	JP	Z,FCLR		;CLR°²¹´° 	CP	19°²¹µ° 	JP	Z,GO		;JP°²¹¶° 	CP	20°²¹·° 	JP	Z,LAB		;LABEL MARK°²¹¸° 	CP	21°²¹¹° 	JP	Z,CRMN		;?RM#°³°°° 	CP	22°³°±° 	JP	Z,RME		;RM=°³°²° 	CP	23°³°³° 	JP	Z,DELA		;DEL:°³°´° 	CP	32°³°µ° 	JP	Z,NON		;NOUN:°³°¶° 	CP	30°³°·° 	JP	Z,FLGC		;?FLG/lable/#°³°¸° 	CP	31°³°¹° 	JP	Z,VB		;VERB°³°¹² 	CP	25°³°¹´ 	JP	Z,CRM		;?RM:°³°¹¶ 	CP	26°³°¹¸ 	JP	Z,CHINA		;?IN:°³±±° 	CP	40°³±²° 	JP	Z,NOEND		;NEND°³±³° 	CP	42°³±¶° 	JP	Z,ENDO°³±¶² 	CP	41°³±¶´ 	JP	Z,INPT°³±·° 	CP	28		;?FLG/lable/>#°³±¸° 	JP	Z,FLGG°³±¹° 	CP	29°³±¹µ 	JP	Z,FLGL°³²°° 	LD	HL,ILEG°³²±° 	CALL	PRINT°³²²° 	INC	HL°³²³° 	JP	CNT3A°³³°° INPN	LD	A,(NOUN)°³³±° 	CALL	INADD°³³²° 	INC	HL°³³³° 	JP	CNT3A°³³´° INMN	LD	A,(NOUN)°³³µ° 	CALL	INSUB°³³¶° 	INC	HL°³³·° 	JP	CNT3A°³³¸° RMPN	LD	A,(NOUN)°³³¹° 	CALL	RMADD°³´°° 	INC	HL°³´±° 	JP	CNT3A°³´²° RMMN	LD	A,(NOUN)°³´³° 	CALL	RMSUB°³´´° 	INC	HL°³´µ° 	JP	CNT3A°³´¶° CIN	LD	A,(NOUN)°³´¶± 	CP	0FFH°³´¶² 	JR	Z,CIN2°³´·° 	CALL	ININ°³´¸° 	JR	Z,CIN1°³´¹° CIN2	XOR	A°³µ°° 	LD	(YN),A°³µ±° 	INC	HL°³µ²° 	JP	CNT3A°³µ³° CIN1	LD	A,1°³µ´° 	LD	(YN),A°³µµ° 	INC	HL°³µ¶° 	JP	CNT3A°³µ·° CRN	LD	A,(NOUN)°³µ·² 	CP	0FFH°³µ·³ 	JR	Z,CIN1°³µ¸° 	CALL	INRM°³µ¹° 	JR	Z,CIN1°³¶°° 	JR	CIN2°³¶²° CHKN	LD	A,(NOUN)°³¶³° 	CALL	INRM°³¶´° 	JR	Z,YEP°³¶µ° 	LD	A,(NOUN)°³¶¶° 	CALL	ININ°³¶·° 	JR	Z,YEP°³¶¸° 	LD	HL,NOT°³¶¹° 	CALL	PRINT°³·°° 	JP	INP°³·±° YEP	INC	HL°³·²° 	JP	CNT3A°³·³° DELN	LD	A,(NOUN)°³·´° 	CALL	ININ°³·µ° 	CALL	Z,INSUB°³·¶° 	CALL	INRM°³··° 	CALL	Z,RMSUB°³·¸° 	INC	HL°³·¹° 	JP	CNT3A°³¸±° TY	INC	HL°³¸²° 	LD	A,(HL)°³¸³° 	PUSH	HL°³¸´° 	LD	HL,(MEM+6)	;MSG TABLE°³¸µ° 	CALL	LOOK°³¸¶° 	CALL	PRINT°³¸·° 	POP	HL°³¸¸° 	INC	HL°³¸¹° 	JP	CNT3A°³¹°° RMP	INC	HL°³¹±° 	LD	A,(HL)°³¹²° 	CALL	RMADD°³¹³° 	INC	HL°³¹´° 	JP	CNT3A°³¹µ° RMM	INC	HL°³¹¶° 	LD	A,(HL)°³¹·° 	CALL	RMSUB°³¹¸° 	INC	HL°³¹¹° 	JP	CNT3A°´°°° INVP	INC	HL°´°±° 	LD	A,(HL)°´°²° 	CALL	INADD°´°³° 	INC	HL°´°´° 	JP	CNT3A°´°µ° INVM	INC	HL°´°¶° 	LD	A,(HL)°´°·° 	CALL	INSUB°´°¸° 	INC	HL°´°¹° 	JP	CNT3A°´±°° FINC	INC	HL°´±±° 	CALL	FLOOK°´±²° 	LD	A,(DE)°´±³° 	INC	A°´±´° 	LD	(DE),A°´±µ° 	INC	HL°´±¶° 	JP	CNT3A°´±·° FDEC	INC	HL°´±¸° 	CALL	FLOOK°´±¹° 	LD	A,(DE)°´²°° 	DEC	A°´²±° 	LD	(DE),A°´²²° 	INC	HL°´²³° 	JP	CNT3A°´²´° FCLR	INC	HL°´²µ° 	CALL	FLOOK°´²¶° 	XOR	A°´²·° 	LD	(DE),A°´²¸° 	INC	HL°´²¹° 	JP	CNT3A°´³°° GO	INC	HL°´³±° 	LD	A,(HL)°´³±µ 	LD	B,A°´³²° 	LD	HL,MEM+20 	;START OF PROGRAM°´³³° GOLP	LD	A,(HL)°´³´° 	CP	0FFH		;END OF PROG°´³µ° 	JP	Z,ENDO°´³¶° 	CP	20°´³·° 	JR	Z,MAB°´³¸° 	CALL	NXTCOM°´³¹° 	JR	GOLP°´´°° MAB	INC	HL°´´±° 	LD	A,(HL)°´´²° 	CP	B°´´³° 	INC	HL°´´´° 	JP	Z,CNT3A°´´µ° 	CALL	NXTCOM°´´¶° 	JR	GOLP°´´¶² LAB	INC	HL°´´¶´ 	INC	HL°´´¶¶ 	JP	CNT3A°´´·° CRMN	INC	HL°´´¸° 	LD	B,(HL)°´´¹° 	LD	A,(RUM)°´µ°° 	CP	B°´µ±° 	JR	Z,CROK°´µ²° 	XOR	A		;NO°´µ³° 	LD	(YN),A°´µ´° 	INC	HL°´µµ° 	JP	CNT3A°´µ¶° CROK	LD	A,1°´µ·° 	LD	(YN),A°´µ¸° 	INC	HL°´µ¹° 	JP	CNT3A°´¶°° RME	INC	HL°´¶±° 	LD	A,(HL)°´¶²° 	LD	(RUM),A°´¶³° 	INC	HL°´¶´° 	JP	CNT3A°´¶µ° DELA	INC	HL°´¶¶° 	LD	A,(HL)°´¶·° 	CALL	ININ°´¶¸° 	CALL	Z,INSUB°´¶¹° 	CALL	INRM°´·°° 	CALL	Z,RMSUB°´·±° 	INC	HL°´·²° 	JP	CNT3A°´·³° NON	INC	HL°´·´° 	LD	B,(HL)°´·´² 	INC	HL°´·´´ NONA	LD	C,(HL)°´·µ° 	LD	A,(NOUN)°´·¶° 	CP	C°´··° 	JR	Z,NOK°´·¸° 	INC	HL°´·¸² 	DJNZ	NONA°´·¹° NON1	LD	A,(HL)°´·¹± 	CP	32°´·¹² 	JR	Z,NON°´·¹´ 	CP	40°´·¹¶ 	JP	Z,CNT3A°´¸°° 	CP	31		;CB°´¸±° 	JP	Z,CNT3A°´¸²° 	CALL	NXTCOM°´¸³° 	JR	NON1°´¸´° NOK	INC	HL°´¸´² 	DJNZ	NOK°´¸µ° 	JP	CNT3A°´¸¶° FLGC	INC	HL°´¸¹° 	CALL	FLOOK°´¸¹± 	INC	HL°´¸¹² 	LD	B,(HL)		;NUM TO CP°´¹°° 	LD	A,(DE)°´¹±° 	CP	B°´¹²° 	JR	Z,FL1°´¹³° FL2	XOR	A°´¹´° 	LD	(YN),A°´¹µ° 	INC	HL°´¹¶° 	JP	CNT3A°´¹·° FL1	LD	A,1°´¹¸° 	LD	(YN),A°´¹¹° 	INC	HL°µ°°° 	JP	CNT3A°µ°±° VB	INC	HL°µ°²° 	LD	B,(HL)°µ°²µ 	LD	A,(VERB)°µ°³° VB1	INC	HL°µ°´° 	LD	C,(HL)°µ°µ° 	CP	C°µ°¶° 	JR	Z,VBOK°µ°·° 	DJNZ	VB1°µ°¸° 	INC	HL°µ°¹° VBLP	LD	A,(HL)°µ±°° 	CP	0FFH°µ±±° 	JR	Z,HUH°µ±²° 	CP	31°µ±³° 	JP	Z,CNT3A°µ±´° 	CALL	NXTCOM°µ±µ° 	JR	VBLP°µ±¶° HUH	LD	HL,WHAT°µ±·° 	CALL	PRINT°µ±¸° 	JP	INP°µ±¹° VBOK	INC	HL°µ²°° 	DJNZ	VBOK°µ²±° 	JP	CNT3A°µ²²° ENDO	LD	HL,PLAY°µ²²² 	CALL	PRINT°µ²²´ 	CALL	49H°µ²²· 	CP	'N'°µ²²¸ 	JR	Z,ENDO2°µ²³° 	CP	'n'°µ²³² 	JR	Z,ENDO2°µ²³³ 	CP	'Y'°µ²³´ 	JR	Z,NEWG°µ²³µ 	CP	'y'°µ²³¶ 	JR	Z,NEWG°µ²´± 	CALL	ROLL°µ²´¶ 	LD	A,10°µ²´· 	CALL	ROLL°µ²´¸ 	JR	ENDO°µ²µ° NEWG	LD	BC,(LEN)°µ²µµ 	LD	HL,(MEM+14)°µ²¶° 	LD	DE,30T°µ²¶µ 	ADD	HL,DE°µ²·° 	LD	DE,(MEM+10)°µ²·µ 	LDIR°µ²·· 	XOR	A°µ²·¹ 	LD	(RUM),A°µ²¸° 	LD	HL,0°µ²¸± 	LD	(CURPOS),HL°µ²¸² 	JP	BEGIN°µ²¸µ ENDO2	CALL	ROLL°µ²¸¶ 	LD	A,10°µ²¸· 	CALL	ROLL°µ²¸¸ 	JP	402DH°µ³°° CRM	INC	HL°µ³±° 	LD	A,(HL)°µ³²° 	CALL	INRM°µ³³° 	JP	Z,CIN1°µ³´° 	JP	CIN2°µ³µ° CHINA	INC	HL°µ³¶° 	LD	A,(HL)°µ³·° 	CALL	ININ°µ³¸° 	JP	Z,CIN1°µ³¹° 	JP	CIN2°µ´°° NOEND	INC	HL°µ´±° 	JP	CNT3A°µµ°° SAVEG	LD	HL,DOT°µµ±° 	CALL	PRINT°µµ²° 	CALL	49H°µµ³° 	CALL	ROLL°µµ³² 	PUSH	AF°µµ³´ 	LD	A,0DH°µµ³¶ 	CALL	ROLL°µµ³¸ 	POP	AF°µµ´° 	CP	'D'°µµµ° 	JR	Z,DON°µµ¶° 	CP	'd'°µµ·° 	JR	Z,DON°µµ¸° 	CP	'T'°µµ¹° 	JR	Z,SYNC°µ¶°° 	CP	't'°µ¶±° 	JR	Z,SYNC°µ¶²° 	JP	INP°µ¶³° DON	LD	HL,FILE°µ¶´° 	CALL	PRINT°µ¶µ° 	CALL	INPUT°µ¶¶° 	LD	DE,DCB°µ¶·° 	LD	HL,BUFFER°µ¶¸° 	CALL	441CH°µ¶¹° 	LD	HL,BUFFER°µ¶¹µ 	LD	DE,DCB°µ·°° 	LD	B,0°µ·±° 	CALL	4420H°µ·²° 	JR	NZ,DSKERR°µ··° BINGO	LD	HL,(MEM+14)	;START°µ·¸° 	LD	DE,(MEM+10)°µ·¹° 	XOR	A°µ¸°° 	SBC	HL,DE°µ¸±° 	LD	BC,(MEM+10)°µ¸±² 	LD	DE,DCB°µ¸±´ 	LD	A,0FEH°µ¸±¶ 	CALL	1BH°µ¸²¶ 	LD	A,(RUM)°µ¸²¸ 	CALL	1BH°µ¸³° BLP	LD	A,(BC)°µ¸´° 	CALL	1BH°µ¸µ° 	JR	NZ,DSKERR°µ¸¶° 	INC	BC°µ¸·° 	DEC	HL°µ¸¸° 	XOR	A°µ¸¹° 	OR	H°µ¹°° 	OR	L°µ¹±° 	JR	NZ,BLP°µ¹²° 	LD	HL,(MEM+14)°µ¹²² BLP2	LD	A,(HL)°µ¹²´ 	CALL	01BH°µ¹²¶ 	JR	NZ,DSKERR°µ¹²· 	LD	A,(HL)°µ¹²¸ 	CP	0FFH°µ¹³° 	JR	Z,CF°µ¹³² 	INC	HL°µ¹³´ 	JR	BLP2°µ¹³¶ CF	LD	DE,DCB°µ¹³¸ 	CALL	4428H°µ¹´° 	JP	NZ,DSKERR°µ¹´´ 	JP	INP°µ¹µ° DSKERR	LD	HL,DSKIO°µ¹¶° 	CALL	PRINT°µ¹·° 	JP	INP°µ¹¸° SYNC	LD	HL,CASS°µ¹¹° 	CALL	PRINT°µ¹¹² 	LD	A,14°µ¹¹´ 	CALL	33H°¶°°° 	CALL	49H°¶°°± 	CP	01°¶°±° 	JP	Z,INP°¶°±µ 	DI°¶°²° 	LD	HL,(MEM+14)°¶°³° 	LD	DE,(MEM+10)°¶°´° 	XOR	A°¶°µ° 	SBC	HL,DE°¶°¶° 	CALL	212H°¶°·° 	CALL	287H°¶°·² 	LD	A,0FEH°¶°·´ 	CALL	264H°¶°·µ 	LD	A,(RUM)°¶°·¶ 	LD	C,A°¶°·· 	CALL	264H°¶°¸° 	LD	DE,(MEM+10)°¶°¹° 	LD	A,L°¶±°° 	CALL	264H°¶±°² 	LD	A,L°¶±°´ 	ADD	A,C°¶±°¶ 	LD	C,A°¶±±° 	LD	A,H°¶±²° 	CALL	264H°¶±²² 	LD	A,H°¶±²´ 	ADD	A,C°¶±²µ 	LD	C,A°¶±³° WR	LD	A,(DE)°¶±´° 	CALL	264H°¶±´² 	LD	A,(DE)°¶±´´ 	ADD	A,C°¶±´¶ 	LD	C,A°¶±µ° 	INC	DE°¶±¶° 	DEC	HL°¶±·° 	XOR	A°¶±¸° 	OR	H°¶±¹° 	OR	L°¶²°° 	JR	NZ,WR°¶²±° 	LD	HL,(MEM+14)°¶²²° WR2	LD	A,(HL)°¶²³° 	CALL	264H°¶²³± 	LD	A,(HL)°¶²´° 	CP	0FFH°¶²µ° 	JR	Z,WR3°¶²µ² 	ADD	A,C°¶²µ´ 	LD	C,A°¶²¶° 	INC	HL°¶²·° 	JR	WR2°¶²¸° WR3	LD	A,C°¶²¸² 	CALL	264H°¶²¸´ 	XOR	A°¶²¸¶ 	CALL	01F8H°¶³°° 	JP	INP°¶³±° LOADG	LD	HL,DOT°¶³²° 	CALL	PRINT°¶³³° 	CALL	49H°¶³³± 	CALL	ROLL°¶³³² 	PUSH	AF°¶³³´ 	LD	A,0DH°¶³³¶ 	CALL	ROLL°¶³³¸ 	POP	AF°¶³´° 	CP	'D'°¶³µ° 	JR	Z,DSKL°¶³¶° 	CP	'd'°¶³·° 	JR	Z,DSKL°¶³¸° 	CP	'T'°¶³¹° 	JR	Z,TAPL°¶´°° 	CP	't'°¶´±° 	JP	NZ,INP°¶´±µ 	JP	TAPL°¶´²° DSKL	LD	HL,FILE°¶´³° 	CALL	PRINT°¶´´° 	CALL	INPUT°¶´µ° 	LD	HL,BUFFER°¶´¶° 	LD	DE,DCB°¶´·° 	CALL	441CH°¶´¸° 	LD	DE,DCB°¶´¹° 	LD	HL,BUFFER°¶µ°° 	LD	B,0°¶µ±° 	CALL	4424H°¶µ²° 	JP	NZ,DSKERR°¶µ²± 	LD	DE,DCB°¶µ²³ 	LD	HL,(MEM+10)°¶µ²´ 	CALL	13H°¶µ²µ 	CP	0FEH°¶µ²¶ 	JP	NZ,FORERR°¶µ²¸ 	CALL	13H°¶µ²¹ 	LD	(RUM),A°¶µ³° DRD	CALL	13H°¶µ´° 	JR	NZ,EOF°¶µµ° 	LD	(HL),A°¶µ¶° 	INC	HL°¶µ·° 	JR	DRD°¶µ¸° EOF	CP	28°¶µ¹° 	JP	NZ,DSKERR°¶µ¹² 	CALL	01C9H°¶µ¹´ 	LD	HL,0°¶µ¹¶ 	LD	(CURPOS),HL°¶¶°° 	JP	START2°¶¶±° TAPL	LD	HL,CASS°¶¶²° 	CALL	PRINT°¶¶²² 	LD	A,14°¶¶²´ 	CALL	33H°¶¶³° 	CALL	49H°¶¶³± 	CP	01°¶¶´° 	JP	Z,INP°¶¶´µ 	DI°¶¶µ° 	XOR	A°¶¶¶° 	CALL	212H°¶¶·° 	CALL	296H°¶¶·± 	CALL	235H°¶¶·² 	CP	0FEH°¶¶·³ 	JP	NZ,FOR1°¶¶·´ 	CALL	235H°¶¶·µ 	LD	(RUM),A°¶¶·¶ 	LD	C,A°¶¶¸° 	CALL	314H°¶¶¹° 	LD	DE,(MEM+10)°¶¶¹² 	LD	A,H°¶¶¹³ 	ADD	A,C°¶¶¹´ 	LD	C,A°¶¶¹µ 	LD	A,L°¶¶¹¶ 	ADD	A,C°¶¶¹· 	LD	C,A°¶·°° TL	CALL	235H°¶·±° 	LD	(DE),A°¶·±² 	ADD	A,C°¶·±´ 	LD	C,A°¶·²° 	INC	DE°¶·³° 	DEC	HL°¶·´° 	XOR	A°¶·µ° 	OR	H°¶·¶° 	OR	L°¶··° 	JR	NZ,TL°¶·¸° 	LD	DE,(MEM+14)°¶·¹° TL2	CALL	235H°¶¸°° 	LD	(DE),A°¶¸°² 	ADD	A,C°¶¸°´ 	LD	C,A°¶¸°µ 	LD	A,(DE)°¶¸±° 	INC	DE°¶¸²° 	CP	0FFH°¶¸²² 	JR	NZ,TL2°¶¸²´ 	CALL	235H°¶¸²µ 	INC	C°¶¸²¶ 	CP	C°¶¸²¸ 	JP	NZ,CSER°¶¸³² 	XOR	A°¶¸³´ 	CALL	01F8H°¶¸³µ 	CALL	01C9H°¶¸³· 	LD	HL,0°¶¸³¹ 	LD	(CURPOS),HL°¶¸´° 	JP	START2°¶¸¸° FOR1	XOR	A°¶¸¹° 	CALL	01F8H°¶¹°° FORERR	LD	HL,FERR°¶¹±° 	CALL	PRINT°¶¹²° 	JP	INP°¶¹²² CSER	XOR	A°¶¹²´ 	CALL	01F8H°¶¹³° 	LD	HL,CER°¶¹´° 	CALL	PRINT°¶¹µ° 	JP	INP°·°°° FLGG	INC	HL°·°±° 	CALL	FLOOK°·°²° 	INC	HL°·°³° 	LD	B,(HL)°·°´° 	LD	A,(DE)°·°µ° 	CP	B°·°¶° 	JP	C,FL2°·°¶µ 	JP	Z,FL2°·°·° 	JP	FL1°·°¸° FLGL	INC	HL°·°¹° 	CALL	FLOOK°·±°° 	INC	HL°·±±° 	LD	A,(DE)°·±²° 	LD	B,(HL)°·±³° 	CP	B°·±´° 	JP	C,FL1°·±µ° 	JP	FL2°¹°°° CTOP	LD	HL,(LIN)°¹±³° 	LD	DE,3C00H+1°¹±´° 	XOR	A°¹±µ° 	SBC	HL,DE°¹±¶° 	PUSH	HL°¹±·° 	POP	BC°¹±¸° 	LD	HL,3C00H°¹±¹° 	LD	DE,3C01H°¹²°° 	LD	A,20H°¹²±° 	LD	(HL),A°¹²²° 	LDIR°¹²³° 	LD	HL,(401DH+3)°¹²´° 	LD	(CURPOS),HL°¹²µ° 	RET°¹²¶° ;SCROLL	-	IF 10 OR 0D BEING PRINTED & ON BOTTOM °¹²·° ;LINE SCROLL°¹²¸° ROLL	CP	0DH°¹²¹° 	JR	Z,SCROLL°¹³°° 	CP	10°¹³±° 	JP	NZ,33H°¹³²° SCROLL	PUSH	HL°¹³³° 	PUSH	DE°¹³´° 	PUSH	BC°¹³´µ 	PUSH	AF°¹³´· 	LD	A,15°¹³´¹ 	CALL	33H		;C OFF°¹³µ° 	LD	HL,(401DH+3)°¹³¶° 	LD	DE,3C00H+15*64°¹³·° 	XOR	A°¹³¸° 	SBC	HL,DE°¹³¹° 	JR	C,NOROL°¹´°° 	LD	DE,(LIN)°¹µ²° 	LD	HL,3C00H+15*64°¹µ³° 	XOR	A°¹µ¶° 	SBC	HL,DE°¹µ·° 	PUSH	HL°¹µ¸° 	POP	BC°¹µ¹° 	LD	DE,(LIN)°¹¶°° 	LD	HL,64°¹¶°µ 	ADD	HL,DE°¹¶±° 	LDIR°¹¶²° 	LD	HL,3C00H+15*64°¹¶³° 	LD	(401DH+3),HL°¹¶´° 	LD	DE,3C00H+15*64+1°¹¶µ° 	LD	BC,63°¹¶¶° 	LD	(HL),20H°¹¶·° 	LDIR°¹¶·µ 	POP	AF°¹¶¸° 	POP	BC°¹¶¹° 	POP	DE°¹·°° 	POP	HL°¹·±° 	RET°¹·²° NOROL	POP	AF°¹·²µ 	POP	BC°¹·³° 	POP	DE°¹·´° 	POP	HL°¹·µ° 	JP	33H±°°°° EXTFND	LD	A,(RUM)		;EXIT TABLE OF RM->HL&IX±°°±° 	LD	E,A±°°²° 	LD	D,0		;LD DE,A±°°³° 	LD	HL,(MEM)	;START OF EXIT TABLES±°°´° 	LD	B,6±°°µ° EXT1	ADD	HL,DE±°°¶° 	DJNZ	EXT1±°°·° 	PUSH	HL±°°¸° 	POP	IX±°°¹° 	RET±°±°° ;INPUT	INPUTS A STRNG INTO BUFFER AS ALL CAPS±°±±° INPUT	LD	A,0EH±°±²° 	CALL	33H		;TURN ON CURSOR±°±³° 	LD	B,50D		;MAX INPUT±°±´° 	LD	HL,BUFFER±°±µ° INP1	CALL	49H±°±¶° 	CP	08±°±·° 	JR	Z,BS±°±·± 	CP	13±°±·² 	JR	Z,LEG±°±·³ 	CP	32±°±·´ 	JP	C,INP1±°±¸° LEG	CALL	ROLL±°±¹° 	CP	65±°²°° 	JR	C,SPIK		;MAKE UC±°²±° 	AND	223±°²´° SPIK	LD	(HL),A±°²µ° 	INC	HL±°²¶° 	CP	0DH±°²·° 	RET	Z±°²¸° 	DJNZ	INP1±°²¹° 	LD	(HL),0DH±°³°° 	RET±°³±° BS	PUSH	HL±°³²° 	LD	DE,BUFFER±°³³° 	XOR	A±°³´° 	SBC	HL,DE±°³µ° 	POP	HL±°³¶° 	JR	Z,INP1±°³·° 	DEC	HL±°³¸° 	LD	A,8±°³¹° 	CALL	33H±°´°° 	JR	INP1±°´µ° ;PRINT	-	PRINT STRING AT HL INTILL A 0 OR 0DH±°´¶° PRINT	PUSH	HL±°´·° 	PUSH	AF±°´·² 	LD	A,14±°´·´ 	CALL	33H±°´¸° LP2	LD	A,(HL)±°´¹° 	CP	0±°µ°° 	JR	Z,CLEAN±°µ±° 	CALL	ROLL±°µ²° 	CP	0DH±°µ³° 	JR	Z,CLEAN±°µ´° 	INC	HL±°µµ° 	JR	LP2±°µ¶° CLEAN	POP	AF±°µ·° 	POP	HL±°µ¸° 	RET±°µ¹° ;LOOK	-	FIND ITEM A IN TABLE AT HL±°µ¹µ LOOK	PUSH	DE		;SAVE±°µ¹¶ 	PUSH	BC±°¶°° 	SLA	A		;A*2 FOR WORDS±°¶±° 	LD	C,A±°¶²° 	LD	B,0		;LD	BC,A±°¶³° 	ADD	HL,BC±°¶´° 	LD	E,(HL)±°¶µ° 	INC	HL±°¶¶° 	LD	D,(HL)±°¶·° 	EX	DE,HL±°¶·µ 	POP	BC±°¶¸° 	POP	DE±°¶¹° 	RET±°·°° ;RSFIND	-	POINT TO CURRENT ROOM ITEM TABLE WITH HL±°·±° RSFIND	PUSH	DE±°·±µ 	PUSH	BC±°·²° 	LD	HL,(MEM+10)	;POINT TO LIST OF ITEMS±°·³° 	LD	A,(RUM)±°·´° 	LD	E,A±°·µ° 	LD	D,0		;LD	DE,A±°·¶° 	LD	B,20D		;RUM*TABLE START±°··° RSLP	ADD	HL,DE±°·¸° 	DJNZ	RSLP±°·¹° 	POP	BC±°¸°° 	POP	DE±°¸±° 	RET±°¸±µ ;CMPR	-	COMARE DE & HL ±°¸²° ; CMPARES TO A 0D OR 00 IN HL, OR A MAX OF 4 CHARS±°¸²µ CMPR	PUSH	HL±°¸³° 	PUSH	DE±°¸³² 	PUSH	BC±°¸³µ 	LD	B,04D±°¸´° 	EX	DE,HL±°¸´µ HEE	LD	C,(HL)±°¸µ° 	LD	A,(DE)±°¸µµ 	CP	00±°¸¶° 	JR	Z,HERE±°¸¶µ 	CP	0DH±°¸·° 	JR	Z,HERE±°¸·µ 	CP	C±°¸¸° 	JR	NZ,HERE±°¸¸µ 	INC	HL±°¸¹° 	INC	DE±°¸¹µ 	DJNZ	HEE±°¸¹· HERE	POP	BC±°¹°° 	POP	DE±°¹°µ 	POP	HL±°¹±° 	RET±°¹³° ;FIND	-	HL -> POS OF TABLE IN MEM±°¹´° ;		DE -> NOUN/VERB TO FIND±°¹µ° ;	FINDS THE ENTRY NUMBER FOR A NOUN/VERB±°¹¶° FIND	PUSH	HL±°¹·° 	POP	IX±°¹·² 	LD	B,0±°¹¸° FLOOP	LD	H,(IX+1)±°¹¹° 	LD	L,(IX+0)±±°°° 	XOR	A±±°±° 	OR	H±±°²° 	OR	H±±°³° 	JR	Z,FIN±±°´° 	CALL	CMPR±±°µ° 	RET	Z±±°¶° 	INC	B±±°·° 	INC	IX±±°¸° 	INC	IX±±°¹° 	JR	FLOOP±±±°° FIN	LD	A,0FFH		;SET NZ FLAG±±±°± 	OR	A±±±±° 	RET±±±²° ;PUT	- PRINTS HL TILL A 0D OR 20H BUT WITH NO C/R±±±³° PUT	LD	A,(HL)±±±´° 	CP	20H±±±µ° 	RET	Z±±±¶° 	CP	0DH±±±·° 	RET	Z±±±¸° 	CALL	ROLL±±±¹° 	INC	HL±±²°° 	JR	PUT±±²±° ;RMADD	- PUT A INTO THE CURRENT ROOM±±²±µ RMADD	PUSH	HL±±²²° 	PUSH	AF±±²³° 	CALL	RSFIND		;PUT START OF ROOM TO HL±±²´° RMLP	LD	A,(HL)±±²µ° 	CP	0FFH		;FREE SPACE±±²¶° 	JR	Z,FND±±²·° 	INC	HL±±²¸° 	JR	RMLP±±²¹° FND	POP	AF±±³°° 	LD	(HL),A±±³°µ 	POP	HL±±³±° 	RET±±³²° ;RMSUB	- TAKE ITEM A OUT OF THE RM±±³³° RMSUB	PUSH	HL		;SAVE±±³´° 	LD	C,A±±³µ° 	CALL	RSFIND±±³¶° 	LD	B,20		;MAX TO SEARCH±±³·° RMLP2	LD	A,(HL)±±³¸° 	CP	C±±³¹° 	JR	Z,FND2±±´°° 	INC	HL±±´±° 	DJNZ	RMLP2±±´²° 	LD	HL,ERR2±±´³° 	CALL	PRINT±±´´° 	POP	HL±±´´µ 	LD	A,C±±´µ° 	RET±±´¶° FND2	LD	A,0FFH±±´·° 	LD	(HL),A±±´·µ 	LD	A,C±±´¸° 	POP	HL±±´¹° 	RET±±µ°° ;INADD	-	ADD AN ITEM TO THE INVENTORY±±µ±° INADD	PUSH	HL±±µ±µ 	PUSH	BC±±µ²´ 	LD	B,A±±µ²µ 	LD	HL,(MEM+14)		;INVENTORY TABLE±±µ³° INLP	LD	A,(HL)±±µ´° 	CP	0FFH±±µµ° 	JR	Z,INOK±±µ¶° 	INC	HL±±µ·° 	JR	INLP±±µ¸° INOK	LD	A,B±±µ¹° 	LD	(HL),A±±¶°° 	INC	HL±±¶±° 	LD	A,0FFH±±¶²° 	LD	(HL),A±±¶²² 	LD	A,B±±¶²´ 	POP	BC±±¶³° 	POP	HL±±¶´° 	RET±±¶µ° ;INSUB	-	DELETE A FROM THE INVENTORY±±¶¶° INSUB	PUSH	HL±±¶·° 	PUSH	BC±±¶·µ 	LD	B,A±±¶¸° 	LD	HL,(MEM+14)	;INVENT START±±¶¹° INLP2	LD	A,(HL)±±·°° 	CP	0FFH±±·±° 	JR	Z,INERR±±·²° 	CP	B±±·³° 	JR	Z,OKY±±·´° 	INC	HL±±·µ° 	JR	INLP2±±·¶° INERR	LD	HL,INER±±··° 	CALL	PRINT±±·¸° 	JR	IEN±±¸±° OKY	PUSH	HL±±¸²° 	POP	IX±±¸³° OKY2	LD	A,(IX+1)±±¸´° 	LD	(IX+0),A±±¸µ° 	CP	0FFH±±¸¶° 	JR	Z,IEN±±¸·° 	INC	IX±±¸¸° 	JR	OKY2±±¸¸² IEN	LD	A,B±±¸¹° 	POP	BC±±¹°° 	POP	HL±±¹±° 	RET±±¹±µ ;INRM	-	SEE IF A IS IN THE CURRENT ROOM±±¹²µ INRM	PUSH	HL±±¹²¶ 	PUSH	BC±±¹²· 	PUSH	AF±±¹²¸ 	CALL	RSFIND±±¹³µ 	POP	AF		;FIND CURRENT ROOM±±¹³¶ 	LD	B,20D±±¹´µ INRM1	LD	C,(HL)±±¹µµ 	CP	C±±¹¶µ 	JR	Z,INRM2±±¹·µ 	INC	HL±±¹¸µ 	DJNZ	INRM1±±¹¹° 	LD	B,A±±¹¹µ 	LD	A,0FFH±²°°µ 	OR	A±²°°· 	LD	A,B±²°±µ INRM2	POP	BC±²°²µ 	POP	HL±²°³µ 	RET±²°´° ;ININ	SCAN INVENTOR FOR A±²°µ° ININ	PUSH	HL	±²°¶° 	PUSH	BC±²°¶µ 	LD	B,A±²°·° 	LD	HL,(MEM+14)±²°¸° IN1	LD	A,(HL)±²°¹° 	CP	0FFH±²±°° 	JR	Z,IN2±²±±° 	CP	B±²±²° 	JR	Z,IN3±²±³° 	INC	HL±²±´° 	JR	IN1±²±µ° IN2	LD	A,0FFH±²±¶° 	OR	A±²±¶µ IN3	LD	A,B±²±·° 	POP	BC±²±¸° 	POP	HL±²±¹° 	RET±²²°° ;SKIP - TESTS IF INDICATED FLG=CURRENT FLG, IF NOT SKIPS±²²±° SKIP	LD	B,A±²²±µ 	BIT	6,A±²²²° 	JR	Z,ZERO		;Z=N:±²²´° 	LD	A,(YN)±²²µ° 	CP	1±²²¶° 	JR	Z,SOK±²²¸° 	JR	SKIP2±²³°° ZERO	LD	A,(YN)±²³±° 	CP	0±²³²° 	JR	Z,SOK±²³³° SKIP2	CALL	NXTCOM±²³´° 	SCF		;SET CARRY±²³µ° 	RET±²³¶° SOK	LD	A,B±²³·° 	AND	63±²³¸° 	SCF±²³¹° 	CCF		;RESET C FLAG±²´°° 	RET±²´±° ;NXTCOM	-	LD	SKIP THE CURENT COMAND±²´²° NXTCOM	LD	A,(HL)±²´²µ 	AND	63±²´³° 	CP	11±²´´° 	JR	C,ONE±²´µ° 	CP	28±²´¶° 	JR	C,TWO±²´·° 	CP	31±²´·± 	JR	C,THREE±²´·² 	CP	40±²´·´ 	JR	C,VARI±²´·¶ 	JR	ONE±²´¸° VARI	INC	HL±²´¹° 	LD	A,(HL)±²´¹µ 	PUSH	BC±²µ°° 	LD	C,A±²µ±° 	LD	B,0±²µ²° 	ADD	HL,BC±²µ²µ 	POP	BC±²µ³° 	JR	ONE±²µ´° THREE	INC	HL±²µµ° TWO	INC	HL±²µ¶° ONE	INC	HL±²µ·° 	RET±²µ¸° FLOOK	PUSH	HL	;FIND FLAG @ HL±²µ¹° 	PUSH	BC±²¶°° 	LD	B,0±²¶±° 	LD	A,(HL)±²¶²° 	LD	C,A±²¶³° 	LD	HL,(MEM+12)±²¶´° 	ADD	HL,BC±²¶µ° 	EX	DE,HL±²¶¶° 	POP	BC±²¶·° 	POP	HL±²¶¸° 	RET±²¶¹° ;FIND2	LOOKS FOR DE IN HL.±²·°° ;LOOKS HARDER THAN FIND DOES.±²·±° FIND2	PUSH	HL±²·²° 	POP	IX±²·³° 	LD	C,0±²·´° 	LD	B,0FFH±²·´µ ANN	INC	B±²·¶° 	LD	L,(IX+0)±²··° 	LD	H,(IX+1)±²·¸° 	LD	A,H±²·¹° 	OR	L±²¸°° 	JR	Z,WOOD±²¸±° ANN2	CALL	CMPR±²¸²° 	JR	Z,WFND±²¸³° AMW	LD	A,(HL)±²¸³µ 	INC	HL±²¸´° 	CP	0DH±²¸µ° 	JR	Z,ANN3±²¸¶° 	CP	20H±²¸·° 	JR	Z,ANN2±²¸¸° 	CP	00±²¸¹° 	JR	Z,ANN3±²¹±° 	JR	AMW±²¹²° ANN3	INC	IX±²¹²µ 	INC	IX±²¹³° 	JR	ANN±²¹·° WFND	PUSH	BC		;B=#, C=NO OF #±²¹¹° 	INC	C±²¹¹² 	INC	IX±²¹¹´ 	INC	IX±³°°° 	JR	ANN±³°±° WOOD	LD	A,C±³°²° 	CP	0±³°³° 	JR	Z,NOMAT±³°´° WOOD1	POP	BC±³°µ° 	LD	A,B±³°¶° 	CALL	INRM±³°·° 	JR	Z,KEG±³°¸° 	CALL	ININ±³°¹° 	JR	Z,KEG±³°¹² 	LD	A,C±³°¹´ 	CP	0±³°¹¶ 	JR	NZ,WOOD1±³°¹· KEG	LD	D,B±³±°° CLEAN2	LD	A,C±³±°± 	CP	00±³±°² 	JR	Z,CLEAN3±³±°³ 	POP	BC±³±°´ 	LD	A,B±³±°¶ 	CALL	INRM±³±°· 	JR	Z,WHI±³±°¸ 	CALL	ININ±³±°¹ 	JR	NZ,CLEAN2±³±±µ WHI	LD	A,C±³±²° 	CP	0±³±²µ 	JR	Z,WHI2±³±³° 	POP	BC±³±³µ 	JR	WHI±³±´° WHI2	LD	HL,CLER±³±´µ 	CALL	PRINT±³±µ° 	POP	HL±³±µµ 	JP	INP±³±¸° NOMAT	LD	A,0FFH±³±¹° 	OR	A±³²°° 	RET±³²±° 	POP	BC±³²²° 	JR	CLEAN2±³²³° CLEAN3	LD	B,D±³²´° 	RET±³²µ° ;TYPE -	PRINT ITEM AT HL TILL 0. DOES NOT OVERLAP±³²¶° ;	SCREEN±³²·° TYPE	PUSH	BC±³²·± 	PUSH	HL±³²·µ 	PUSH	HL±³²¸° TY1	LD	A,(HL)±³²¹° 	CP	0±³³°° 	JR	Z,TY2±³³±° 	INC	HL±³³²° 	JR	TY1±³³³° TY2	POP	DE±³³´° 	XOR	A±³³µ° 	INC	HL		;ADJUST FOR ". "±³³¶° 	SBC	HL,DE±³³¶µ 	PUSH	HL±³³·° 	LD	HL,(401DH+3)	;HL - 64±³³·µ 	CALL	KOUNT±³³¸° 	LD	(TEM),A±³³¹° 	LD	HL,(401DH+3)±³´°° 	POP	BC±³´±° 	ADD	HL,BC±³´²° 	CALL	KOUNT±³´²µ 	LD	B,A±³´²¶ 	LD	A,(TEM)±³´³° 	POP	HL±³´´° 	SUB	B±³´´µ 	POP	BC±³´µ° 	JP	Z,PRINT±³´¶° 	LD	A,0DH±³´·° 	CALL	ROLL±³´¸° 	JP	PRINT±³´¹° KOUNT	XOR	A±³µ°° 	LD	DE,3C00H±³µ±° 	SBC	HL,DE±³µ²° 	LD	DE,64T±³µ³° K1	SBC	HL,DE±³µ´° 	RET	C±³µµ° 	INC	A±³µ¶° 	JR	K1±³µ·° ;SCRPRT		PRINT TITLE PAGE±³µ¸° SCRPRT	LD	E,(HL)±³µ¹° 	INC	HL±³¶°° 	LD	D,(HL)±³¶±° 	INC	HL±³¶²° 	XOR	A±³¶³° 	OR	E±³¶´° 	OR	D±³¶µ° 	RET	Z±³¶¶° 	LD	C,(HL)±³¶·° 	INC	HL±³¶¸° 	LD	B,(HL)±³¶¹° 	INC	HL±³·°° 	LDIR±³·±° 	JR	SCRPRTµ°°°° ;LIST OF ITEMSµ°°°µ NORTH	DEFM	'NORTH. 'µ°°±° 	DEFB	00µ°°±µ SOUTH	DEFM	'SOUTH. 'µ°°²° 	DEFB	0µ°°²µ EAST	DEFM	'EAST. 'µ°°³° 	DEFB	0µ°°³µ WEST	DEFM	'WEST. 'µ°°´° 	DEFB	0µ°°´µ UP	DEFM	'UP'µ°°µ° 	DEFB	0µ°°µµ DOWN	DEFM	'DOWN. 'µ°°¶° 	DEFB	0µ°°·° INV	DEFM	'INVE'µ°°¸° 	DEFB	0µ°°¹° SAV	DEFM	'SAVE'µ°±°° 	DEFB	0µ°±±° LOA	DEFM	'LOAD'µ°±²° 	DEFB	0µ±°°° ;TEXT STATMENTSµ±°°µ ISEE	DEFM	'I can see: 'µ±°±° 	DEFB	0µ±°·µ LINE	DEFB	15µ±°¸° 	DEFM	'<-------------------------------------------------------------->'µ±°¹° 	DEFB	0µ±±°° PRED	DEFM	'You are 'µ±±±° 	DEFB	00µ±±²° PROM	DEFM	'Now what ===--> 'µ±±³° 	DEFB	00µ±±´° DSP	DEFM	'. 'µ±±µ° 	DEFB	0µ±±¶° BADIN	DEFM	'I don'µ±±·° 	DEFB	39µ±±¸° 	DEFM	't understand.'µ±±¹° 	DEFB	0DHµ±²°° BADDI	DEFM	'I can not go that way.'µ±²±° 	DEFB	0DHµ±²²° INVEMP	DEFM	'I am not carrying anything.'µ±²³° 	DEFB	0DHµ±²´° VERR	DEFM	'I don'µ±²´± 	DEFB	39µ±²´² 	DEFM	't know how to 'µ±²µ° 	DEFB	00µ±²¶° ERRN	DEFM	'I don'µ±²·° 	DEFB	39µ±²¸° 	DEFM	't know what a 'µ±²¹° 	DEFB	0µ±³°° ERRN2	DEFM	' is.'µ±³±° 	DEFB	0DHµ±³²° WAY	DEFM	'Obvious exits are: 'µ±³³° 	DEFB	0µ±³³² ERR2	EQU	$µ±³³´ INER	EQU	$µ±³´° ILEG	DEFM	'SYSERR'µ±³µ° 	DEFB	0DHµ±´°° NOT	DEFM	'There is not one here!'µ±´±° 	DEFB	0DHµ±´²° WHAT	DEFM	'I do not understand.'µ±´³° 	DEFB	0DHµ±´´° PLAY	DEFM	'Do you wish to play another game? 'µ±´µ° 	DEFB	0µ±´¶° CLER	DEFM	'Please be more specific.'µ±´·° 	DEFB	0DHµ±´¸° CASS	DEFM	'Ready cassette'µ±´¹° 	DEFB	0DHµ±µ°° FILE	DEFM	'Enter the file name --> 'µ±µ±° 	DEFB	0µ±µ²° DOT	DEFM	'Use Disk or Tape? 'µ±µ³° 	DEFB	0µ±µ´° DSKIO	DEFM	'Disk I/O error!'µ±µµ° 	DEFB	0DHµ±µ¶° FERR	DEFM	'This is not a saved adventure!'µ±µ·° 	DEFB	0DHµ±µ¸° CER	DEFM	'Check sum error! probably fatel.'µ±µ¹° 	DEFB	0DH¶°°°° ;VARIABLES¶°°±° BUFFER	DEFS	256D¶°°±µ DCB	DEFS	50D¶°°²° RUM	DEFB	0¶°°³° NN	DEFW	0¶°°´° VERB	DEFB	0¶°°µ° NOUN	DEFB	0¶°°¶° YN	DEFB	0¶°°·° LEN	DEFW	0¶°°¸° CURPOS	DEFW	0¶°°¹° LIN	DEFW	0¶°°¹± TEM	DEFB	0¶°±°° SIZE	DEFB	0¶°±°µ MEM	EQU	$¶±°°° 	END	5200H                          